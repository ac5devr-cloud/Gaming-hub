<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper Pong Duel - 2 Player Arcade (WOLNIEJ + ESC)</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        /* 90s ARCADE STYLES */
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #000033; /* Ciemnoniebieskie tło */
            color: #ccff00; /* Neonowo-zielony tekst */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            user-select: none; /* Wyłącza zaznaczanie tekstu */
            font-size: 10px;
            overflow: hidden; 
        }

        h1 { 
            text-shadow: 3px 3px #ff00ff; /* Neonowy cień */
            margin-bottom: 15px; 
            font-size: 1.8rem;
        }

        /* GAME SCREEN */
        .game-container {
            border: 5px solid #00ffff; /* Błękitna ramka */
            box-shadow: 0 0 30px #00ffff, 0 0 15px #ff00ff;
            background-color: #000000;
            padding: 10px;
            position: relative;
        }

        #gameCanvas {
            background-color: #000000;
            display: block;
        }

        /* SCOREBOARD */
        .scoreboard {
            width: 100%;
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.2rem;
            color: #00ffff;
        }
        
        .controls-info {
            margin-top: 20px;
            padding: 10px;
            border: 2px solid #ff00ff;
            background-color: #1a004d;
            font-size: 0.7rem;
            line-height: 1.5;
            text-align: center;
        }
        
        .controls-info span {
            color: #ccff00;
        }
    </style>
</head>
<body>

    <h1>HYPER PONG DUEL</h1>
    
    <div class="scoreboard" id="scoreboard">
        PLAYER 1: 0 | PLAYER 2: 0
    </div>

    <div class="game-container">
        <canvas id="gameCanvas" width="600" height="400"></canvas>
    </div>

    <div class="controls-info">
        <p>PLAYER 1: <span style="color: #ff00ff;">WASD</span> | PLAYER 2: <span style="color: #00ffff;">STRZAŁKI</span></p>
        <p>Start: <span style="color: #ccff00;">SPACE</span> | Pause: <span style="color: #ccff00;">ESC</span></p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreboard = document.getElementById('scoreboard');

        // --- GAME CONSTANTS ---
        const PADDLE_WIDTH = 10;
        const PADDLE_HEIGHT = 80;
        const BALL_SIZE = 8;
        const PADDLE_SPEED = 6;
        const MAX_SCORE = 5;
        
        // --- KLUCZOWA ZMIANA: JESZCZE WOLNIEJSZA PIŁKA ---
        const INITIAL_BALL_SPEED = 1.8; 

        // --- GAME STATE ---
        let running = false;
        let paused = false; // Nowy stan pauzy
        let scoreP1 = 0;
        let scoreP2 = 0;
        let keys = {};

        // Paddle objects
        let paddle1 = {
            x: 20,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            dy: 0,
            color: '#ff00ff' 
        };

        let paddle2 = {
            x: canvas.width - 20 - PADDLE_WIDTH,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            dy: 0,
            color: '#00ffff' 
        };

        // Ball object
        let ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            dx: 0, 
            dy: 0,
            speed: INITIAL_BALL_SPEED,
            color: '#ccff00' 
        };

        // --- EVENT LISTENERS (Control Setup) ---
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            
            if (['w', 's', 'W', 'S', 'ArrowUp', 'ArrowDown', ' ', 'Escape'].includes(e.key)) {
                e.preventDefault();
            }

            // Obsługa pauzy
            if (e.key === 'Escape') {
                togglePause();
            }
            
            // Start gry
            if (e.key === ' ' && !running) {
                startGame();
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });
        
        // --- PAUZA ---
        function togglePause() {
            if (running) {
                paused = !paused;
                if (!paused) {
                    // Wznów grę, jeśli pauza jest wyłączona
                    gameLoop(); 
                } else {
                    // Wyświetl ekran pauzy
                    render(); 
                }
            }
        }


        // --- GAME LOGIC ---

        function resetBall(servingPlayer) {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speed = INITIAL_BALL_SPEED; 
            
            const direction = servingPlayer === 1 ? -1 : 1;
            
            ball.dx = direction * ball.speed;
            ball.dy = (Math.random() * 2 - 1) * ball.speed * 0.5; 
        }

        function startGame() {
            if (scoreP1 >= MAX_SCORE || scoreP2 >= MAX_SCORE) {
                scoreP1 = 0;
                scoreP2 = 0;
            }
            running = true;
            paused = false; 
            resetBall(2); 
            updateScoreboard();
            gameLoop();
        }

        function updateScoreboard() {
            scoreboard.textContent = `PLAYER 1: ${scoreP1} | PLAYER 2: ${scoreP2}`;
        }

        function handleInput() {
            if (paused) return; // Zablokuj ruch, gdy gra jest spauzowana
            
            // Player 1 (W/S)
            paddle1.dy = 0;
            if (keys['w'] || keys['W']) {
                paddle1.dy = -PADDLE_SPEED;
            } else if (keys['s'] || keys['S']) {
                paddle1.dy = PADDLE_SPEED;
            }

            // Player 2 (Arrow Keys)
            paddle2.dy = 0;
            if (keys['ArrowUp']) {
                paddle2.dy = -PADDLE_SPEED;
            } else if (keys['ArrowDown']) {
                paddle2.dy = PADDLE_SPEED;
            }
        }

        function update() {
            if (!running || paused) return;

            // 1. Paddle movement
            paddle1.y += paddle1.dy;
            paddle2.y += paddle2.dy;

            // Keep paddles in bounds
            paddle1.y = Math.max(0, Math.min(canvas.height - PADDLE_HEIGHT, paddle1.y));
            paddle2.y = Math.max(0, Math.min(canvas.height - PADDLE_HEIGHT, paddle2.y));

            // 2. Ball movement
            ball.x += ball.dx;
            ball.y += ball.dy;

            // 3. Wall collision (Top/Bottom)
            if (ball.y < 0 || ball.y > canvas.height - BALL_SIZE) {
                ball.dy *= -1; 
            }

            // 4. Paddle collision (Player 1)
            if (ball.x < paddle1.x + PADDLE_WIDTH &&
                ball.y + BALL_SIZE > paddle1.y &&
                ball.y < paddle1.y + PADDLE_HEIGHT &&
                ball.dx < 0) { 
                
                ball.dx *= -1.05; 
                
                let hitPoint = (ball.y - (paddle1.y + PADDLE_HEIGHT / 2)) / (PADDLE_HEIGHT / 2);
                ball.dy = hitPoint * ball.speed * 1.5;
                ball.speed *= 1.05; 
            }
            
            // 5. Paddle collision (Player 2)
            if (ball.x + BALL_SIZE > paddle2.x &&
                ball.y + BALL_SIZE > paddle2.y &&
                ball.y < paddle2.y + PADDLE_HEIGHT &&
                ball.dx > 0) { 
                
                ball.dx *= -1.05; 
                
                let hitPoint = (ball.y - (paddle2.y + PADDLE_HEIGHT / 2)) / (PADDLE_HEIGHT / 2);
                ball.dy = hitPoint * ball.speed * 1.5;
                ball.speed *= 1.05; 
            }

            // 6. Scoring (Left Wall)
            if (ball.x < 0) {
                scoreP2++;
                updateScoreboard();
                checkWin();
                if (running) resetBall(1); 
            }

            // 7. Scoring (Right Wall)
            if (ball.x > canvas.width) {
                scoreP1++;
                updateScoreboard();
                checkWin();
                if (running) resetBall(2); 
            }
        }

        function checkWin() {
            if (scoreP1 >= MAX_SCORE) {
                running = false;
                drawText("PLAYER 1 WINS!", canvas.width / 2, canvas.height / 2, paddle1.color);
                drawText("SPACE to restart", canvas.width / 2, canvas.height / 2 + 30, ball.color);
            } else if (scoreP2 >= MAX_SCORE) {
                running = false;
                drawText("PLAYER 2 WINS!", canvas.width / 2, canvas.height / 2, paddle2.color);
                drawText("SPACE to restart", canvas.width / 2, canvas.height / 2 + 30, ball.color);
            }
        }

        // --- RENDERING ---

        function drawRect(x, y, w, h, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, w, h);
        }

        function drawText(text, x, y, color, size = 18) {
            ctx.fillStyle = color;
            ctx.textAlign = 'center';
            ctx.font = `${size}px "Press Start 2P"`;
            ctx.fillText(text, x, y);
        }

        function render() {
            // Clear canvas
            drawRect(0, 0, canvas.width, canvas.height, '#000000');
            
            // Draw center line (Dashed)
            ctx.strokeStyle = '#333333';
            ctx.lineWidth = 4;
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.stroke();
            ctx.setLineDash([]); 

            // Draw paddles
            drawRect(paddle1.x, paddle1.y, PADDLE_WIDTH, PADDLE_HEIGHT, paddle1.color);
            drawRect(paddle2.x, paddle2.y, PADDLE_WIDTH, PADDLE_HEIGHT, paddle2.color);

            // Draw ball
            drawRect(ball.x, ball.y, BALL_SIZE, BALL_SIZE, ball.color);
            
            // --- EKRANY STANU GRY ---

            // Pauza
            if (paused) {
                drawRect(0, canvas.height / 2 - 40, canvas.width, 80, 'rgba(0, 0, 0, 0.7)');
                drawText("PAUSED", canvas.width / 2, canvas.height / 2 - 10, '#ccff00', 24);
                drawText("Press ESC to continue", canvas.width / 2, canvas.height / 2 + 20, '#00ffff', 10);
            }
            
            // Start/Koniec
            if (!running) {
                 if (scoreP1 === 0 && scoreP2 === 0) {
                     drawText("PRESS SPACE TO START", canvas.width / 2, canvas.height / 2, ball.color);
                 } else {
                     checkWin();
                 }
            }
        }

        function gameLoop() {
            handleInput();
            update();
            render();
            
            // Kontynuuj pętlę tylko jeśli gra działa i nie jest spauzowana
            if (running && !paused) {
                requestAnimationFrame(gameLoop);
            }
        }

        // --- INITIAL START ---
        render(); // Draw initial screen and message
    </script>
</body>
</html>